(()=>{var e={};e.id=716,e.ids=[716],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3254:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>a.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),n(4595),n(7687),n(6560);var r=n(3191),o=n(8716),s=n(7922),a=n.n(s),i=n(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);n.d(t,l);let c=["",{children:["auth",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,4595)),"/home/project/app/auth/login/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(n.bind(n,7687)),"/home/project/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.bind(n,6560)),"/home/project/app/not-found.tsx"]}],d=["/home/project/app/auth/login/page.tsx"],u="/auth/login/page",h={require:n,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/auth/login/page",pathname:"/auth/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},800:(e,t,n)=>{Promise.resolve().then(n.bind(n,1279))},8030:(e,t,n)=>{Promise.resolve().then(n.bind(n,8690))},9763:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2994,23)),Promise.resolve().then(n.t.bind(n,6114,23)),Promise.resolve().then(n.t.bind(n,9727,23)),Promise.resolve().then(n.t.bind(n,9671,23)),Promise.resolve().then(n.t.bind(n,1868,23)),Promise.resolve().then(n.t.bind(n,4759,23))},5303:()=>{},1279:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var r={};n.r(r),n.d(r,{J:()=>m});var o=n(326),s=n(7577),a=n(5047),i=n(3071),l=n(772),c=n(434),d=n(5999),u=n(7427),h=n(1291);function m(e,t){}function x(){let e=(0,r.getSupabaseBrowser)(),t=(0,a.useRouter)(),n=(0,a.useSearchParams)(),x="register"===n.get("mode")?"register":"login",g=n.get("e"),[p,b]=(0,s.useState)(x),[f,j]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[O,y]=(0,s.useState)(!1),[_,w]=(0,s.useState)(""),[E,U]=(0,s.useState)(""),C=async()=>{try{let t="/auth/callback";console.log("[Google OAuth] Redirect to:",t),console.log("[Google OAuth] Current origin:","");let{error:n}=await e.auth.signInWithOAuth({provider:"google",options:{redirectTo:t}});if(n){console.error("[Google OAuth] Error:",n),window.location.href=`/auth/login?e=${encodeURIComponent(n.message)}`;return}console.log("[Google OAuth] Success, redirecting...")}catch(e){console.error("[Google OAuth] Exception:",e),window.location.href=`/auth/login?e=${encodeURIComponent(e?.message||"Google OAuth failed")}`}},A=async()=>{try{let{error:t}=await e.auth.signInWithOAuth({provider:"facebook",options:{redirectTo:"/auth/callback"}});if(t){console.error("[Facebook OAuth] Error:",t),d.Am.error(`Facebook OAuth Error: ${t.message}`);return}}catch(e){console.error("[Facebook OAuth] Exception:",e),d.Am.error(e?.message||"Kh\xf4ng thể đăng nhập Facebook")}},D=async n=>{if(n.preventDefault(),!e){d.Am.error("Thiếu cấu h\xecnh Supabase. Nhập ở khung b\xean dưới.");return}y(!0);try{if("login"===p){let{error:n}=await e.auth.signInWithPassword({email:f,password:v});if(n)throw n;let{data:{user:r}}=await e.auth.getUser();if(!r){d.Am.error("Đăng nhập thất bại");return}let{data:o}=await e.from("profiles").select("onboarding_status").eq("id",r.id).single();t.replace(o?.onboarding_status==="completed"?"/dashboard":"/onboarding")}else{let{data:n,error:r}=await e.auth.signUp({email:f,password:v});if(r)throw r;n.session?t.replace("/onboarding"):d.Am.success("Đăng k\xfd th\xe0nh c\xf4ng! Kiểm tra email để x\xe1c nhận.")}}catch(e){d.Am.error(e?.message||"C\xf3 lỗi xảy ra, vui l\xf2ng thử lại")}finally{y(!1)}};return e?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,o.jsxs)(i.Zb,{className:"w-full max-w-md",children:[(0,o.jsxs)(i.Ol,{className:"text-center",children:[(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[o.jsx(u.Z,{className:"h-8 w-8 text-green-600"}),o.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"DIABOT"})]}),o.jsx(i.ll,{className:"text-2xl",children:"login"===p?"Đăng nhập":"Tạo t\xe0i khoản"}),o.jsx(i.SZ,{children:"login"===p?"Ch\xe0o mừng trở lại!":"Bắt đầu h\xe0nh tr\xecnh quản l\xfd sức khỏe của bạn"})]}),(0,o.jsxs)(i.aY,{children:[g&&(0,o.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/alert'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"mb-4 border-red-200 bg-red-50",children:[o.jsx(h.Z,{className:"h-4 w-4 text-red-600"}),(0,o.jsxs)(Object(function(){var e=Error("Cannot find module '@/components/ui/alert'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"text-red-800",children:["Lỗi OAuth: ",decodeURIComponent(g)]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 gap-2 mb-4",children:[o.jsx(l.z,{variant:"outline",onClick:C,children:"Đăng nhập bằng Google"}),o.jsx(l.z,{variant:"outline",onClick:A,children:"Đăng nhập bằng Facebook"})]}),o.jsx("div",{className:"text-center text-xs text-gray-500 mb-4",children:"hoặc d\xf9ng email"}),(0,o.jsxs)("form",{className:"space-y-4",onSubmit:D,children:[!1,(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/label'");throw e.code="MODULE_NOT_FOUND",e}()),{htmlFor:"email",children:"Email"}),o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/input'");throw e.code="MODULE_NOT_FOUND",e}()),{id:"email",type:"email",required:!0,value:f,onChange:e=>j(e.target.value)})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/label'");throw e.code="MODULE_NOT_FOUND",e}()),{htmlFor:"password",children:"Mật khẩu"}),o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/input'");throw e.code="MODULE_NOT_FOUND",e}()),{id:"password",type:"password",required:!0,value:v,onChange:e=>N(e.target.value)})]}),o.jsx(l.z,{type:"submit",className:"w-full",disabled:O,children:O?"Đang xử l\xfd...":"login"===p?"Đăng nhập":"Đăng k\xfd"})]}),o.jsx("div",{className:"text-sm text-center mt-4",children:"login"===p?(0,o.jsxs)(o.Fragment,{children:["Chưa c\xf3 t\xe0i khoản?"," ",o.jsx("button",{className:"text-blue-600 underline",onClick:()=>b("register"),children:"Đăng k\xfd"})]}):(0,o.jsxs)(o.Fragment,{children:["Đ\xe3 c\xf3 t\xe0i khoản?"," ",o.jsx("button",{className:"text-blue-600 underline",onClick:()=>b("login"),children:"Đăng nhập"})]})}),(0,o.jsxs)("div",{className:"text-xs text-center text-gray-500 mt-6",children:["Bằng c\xe1ch tiếp tục, bạn đồng \xfd với"," ",o.jsx(c.default,{href:"/terms",className:"underline",children:"Điều khoản"})," &"," ",o.jsx(c.default,{href:"/privacy",className:"underline",children:"Ch\xednh s\xe1ch"}),"."]})]})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,o.jsxs)(i.Zb,{className:"w-full max-w-md",children:[(0,o.jsxs)(i.Ol,{className:"text-center",children:[o.jsx(i.ll,{className:"text-2xl",children:"Cấu h\xecnh Supabase (Dev)"}),(0,o.jsxs)(i.SZ,{children:["Chưa thấy ",o.jsx("code",{children:"NEXT_PUBLIC_SUPABASE_URL"})," / ",o.jsx("code",{children:"ANON_KEY"}),". Bạn c\xf3 thể d\xe1n tạm ở đ\xe2y (lưu v\xe0o localStorage) để chạy thử tr\xean StackBlitz."]})]}),(0,o.jsxs)(i.aY,{className:"space-y-3",children:[(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/label'");throw e.code="MODULE_NOT_FOUND",e}()),{children:"SUPABASE URL"}),o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/input'");throw e.code="MODULE_NOT_FOUND",e}()),{value:_,onChange:e=>w(e.target.value),placeholder:"https://xxxx.supabase.co"})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/label'");throw e.code="MODULE_NOT_FOUND",e}()),{children:"SUPABASE ANON KEY"}),o.jsx(Object(function(){var e=Error("Cannot find module '@/components/ui/input'");throw e.code="MODULE_NOT_FOUND",e}()),{value:E,onChange:e=>U(e.target.value),placeholder:"eyJhbGciOi..."})]}),o.jsx(l.z,{className:"w-full",onClick:()=>m(_,E),children:"Lưu & Reload"}),(0,o.jsxs)("p",{className:"text-xs text-center text-gray-500",children:["Khi triển khai thật, h\xe3y d\xf9ng ",o.jsx("code",{children:".env.local"})," thay v\xec c\xe1ch n\xe0y."]})]})]})})}(function(){var e=Error("Cannot find module '@/components/ui/input'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/components/ui/label'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '@/components/ui/alert'");throw e.code="MODULE_NOT_FOUND",e}()},8690:(e,t,n)=>{"use strict";n.d(t,{default:()=>o});var r=n(326);function o({children:e}){return r.jsx(r.Fragment,{children:e})}n(7577)},772:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var r=n(326);function o({className:e="",variant:t="default",size:n="default",...o}){return r.jsx("button",{className:`inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 ${{default:"bg-brand-500 text-white hover:bg-brand-600",outline:"border border-gray-200 bg-white hover:bg-gray-50",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200"}[t]} ${{default:"h-10 px-4 py-2",sm:"h-8 px-3 text-sm",lg:"h-12 px-8"}[n]} ${e}`,...o})}n(7577)},3071:(e,t,n)=>{"use strict";n.d(t,{Ol:()=>s,SZ:()=>l,Zb:()=>o,aY:()=>a,ll:()=>i});var r=n(326);function o({className:e="",...t}){return r.jsx("div",{className:`card ${e}`,...t})}function s({className:e="",...t}){return r.jsx("div",{className:`px-4 pt-4 ${e}`,...t})}function a({className:e="",...t}){return r.jsx("div",{className:`px-4 pb-4 ${e}`,...t})}function i(e){return r.jsx("div",{className:"font-semibold",...e})}function l(e){return r.jsx("div",{className:"text-sm text-slate-500",...e})}n(7577)},4595:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(8570).createProxy)(String.raw`/home/project/app/auth/login/page.tsx#default`)},7687:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a,metadata:()=>s});var r=n(9510);n(7272);let o=(0,n(8570).createProxy)(String.raw`/home/project/components/AuthGate.tsx#default`),s={title:"DIAbot",description:"Trợ l\xfd đường huyết – Ghi nhanh, nhắc việc, b\xe1o c\xe1o tuần"};function a({children:e}){return r.jsx("html",{lang:"vi",children:r.jsx("body",{children:r.jsx(o,{children:e})})})}},6560:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var r=n(9510);function o(){return r.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"card w-full max-w-md p-8 text-center",children:[r.jsx("h1",{className:"text-xl font-semibold",children:"Kh\xf4ng t\xecm thấy trang"}),r.jsx("p",{className:"mt-2 text-slate-600",children:"Kiểm tra lại đường dẫn hoặc quay về Dashboard."}),r.jsx("a",{href:"/dashboard",className:"btn btn-brand mt-4 inline-block",children:"Về Dashboard"})]})})}},7272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,669,205,999],()=>n(3254));module.exports=r})();